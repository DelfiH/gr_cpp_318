#include "task3.h"
#include "autobase.h"
#include <iostream>

//-----------------------------------------------------------------------------
// Метод run класса Task3: выполняет основную логику задачи 3
//-----------------------------------------------------------------------------
void Task3::run() {
    //-------------------------------------------------------------------------
    // Создание диспетчера
    //-------------------------------------------------------------------------
    Dispatcher dispatcher("Евгения"); // Создаём диспетчера с именем "Евгения"
    dispatcher.displayDispatcherInfo(); // Выводим информацию о диспетчере.

    //-------------------------------------------------------------------------
    // Создание автомобилей
    //-------------------------------------------------------------------------
    Car car1("Toyota Camry"); // Создаём автомобиль Toyota Camry.
    Car car2("Ford Transit"); // Создаём автомобиль Ford Transit.

    //-------------------------------------------------------------------------
    // Добавление автомобилей диспетчеру
    //-------------------------------------------------------------------------
    dispatcher.addCar(&car1); // Добавляем Toyota Camry диспетчеру.
    dispatcher.addCar(&car2); // Добавляем Ford Transit диспетчеру.

    //-------------------------------------------------------------------------
    // Вывод информации об автомобилях
    //-------------------------------------------------------------------------
    std::cout << "\nДоступные автомобили:" << std::endl; // Выводим заголовок списка автомобилей.
    for (const Car* car : dispatcher.getCars()) { // Перебираем все автомобили диспетчера.
        car->displayCarInfo(); // Выводим информацию о текущем автомобиле.
    }

    //-------------------------------------------------------------------------
    // Создание водителей
    //-------------------------------------------------------------------------
    Driver driver1("Иван Иванов"); // Создаём водителя Ивана Иванова.
    Driver driver2("Анна Смирнова"); // Создаём водителя Анну Смирнову.

    //-------------------------------------------------------------------------
    // Добавление водителей диспетчеру
    //-------------------------------------------------------------------------
    dispatcher.addDriver(&driver1); // Добавляем Ивана Иванова диспетчеру.
    dispatcher.addDriver(&driver2); // Добавляем Анну Смирнову диспетчеру.

    //-------------------------------------------------------------------------
    // Вывод информации о водителях
    //-------------------------------------------------------------------------
    std::cout << "\nДоступные водители:" << std::endl; // Выводим заголовок списка водителей.
    for (const Driver* driver : dispatcher.getDrivers()) { // Перебираем всех водителей диспетчера.
        driver->displayDriverInfo(); // Выводим информацию о текущем водителе.
    }

    //-------------------------------------------------------------------------
    // Создание рейсов
    //-------------------------------------------------------------------------
    Trip trip1("В центр города"); // Создаём рейс "В центр города".
    Trip trip2("В аэропорт"); // Создаём рейс "В аэропорт".

    //-------------------------------------------------------------------------
    // Добавление рейсов диспетчеру
    //-------------------------------------------------------------------------
    dispatcher.addTrip(&trip1); // Добавляем рейс "В центр города" диспетчеру.
    dispatcher.addTrip(&trip2); // Добавляем рейс "В аэропорт" диспетчеру.

    //-------------------------------------------------------------------------
    // Вывод информации о рейсах
    //-------------------------------------------------------------------------
    std::cout << "\nЗапланированные рейсы:" << std::endl; // Выводим заголовок списка рейсов.
    for (const Trip* trip : dispatcher.getTrips()) { // Перебираем все рейсы диспетчера.
        trip->displayTripInfo(); // Выводим информацию о текущем рейсе.
    }

    //-------------------------------------------------------------------------
    // Создание заявок
    //-------------------------------------------------------------------------
    std::string request1 = "Срочная доставка в порт"; // Создаём заявку "Срочная доставка в порт".
    std::string request2 = "Забрать пассажиров с вокзала"; // Создаём заявку "Забрать пассажиров с вокзала".

    //-------------------------------------------------------------------------
    // Добавление заявок диспетчеру
    //-------------------------------------------------------------------------
    dispatcher.addRequest(request1); // Добавляем заявку "Срочная доставка в порт" диспетчеру.
    dispatcher.addRequest(request2); // Добавляем заявку "Забрать пассажиров с вокзала" диспетчеру.

    //-------------------------------------------------------------------------
    // Назначение рейса водителю и автомобилю
    //-------------------------------------------------------------------------
    std::cout << "\nНазначение рейса:" << std::endl; // Выводим заголовок информации о назначении рейса.
    dispatcher.assignTrip(&trip1, &driver1, &car1); // Назначаем рейс "В центр города" водителю Ивану Иванову на автомобиле Toyota Camry.
    trip1.displayTripInfo(); // Выводим информацию о рейсе.
    driver1.displayDriverInfo(); // Выводим информацию о водителе.
    car1.displayCarInfo(); // Выводим информацию об автомобиле.

    //-------------------------------------------------------------------------
    // Водитель делает отметку о выполнении рейса
    //-------------------------------------------------------------------------
    std::cout << "\nЗавершение рейса:" << std::endl; // Выводим заголовок информации о завершении рейса.
    driver1.markTripCompletion(trip1, car1); // Водитель Иван Иванов отмечает, что рейс "В центр города" на автомобиле Toyota Camry завершён.
    trip1.displayTripInfo(); // Выводим информацию о рейсе.
    driver1.displayDriverInfo(); // Выводим информацию о водителе.
    car1.displayCarInfo(); // Выводим информацию об автомобиле.

    //-------------------------------------------------------------------------
    // Водитель запрашивает ремонт
    //-------------------------------------------------------------------------
    std::cout << "\nЗапрос на ремонт:" << std::endl; // Выводим заголовок информации о запросе на ремонт.
    driver2.requestRepair(car2); // Водитель Анна Смирнова запрашивает ремонт автомобиля Ford Transit.
    driver2.displayDriverInfo(); // Выводим информацию о водителе.
    car2.displayCarInfo(); // Выводим информацию об автомобиле.

    //-------------------------------------------------------------------------
    // Диспетчер отстраняет водителя
    //-------------------------------------------------------------------------
    std::cout << "\nОтстранение водителя:" << std::endl; // Выводим заголовок информации об отстранении водителя.
    dispatcher.suspendDriver(&driver2); // Диспетчер отстраняет водителя Анну Смирнову.
    driver2.displayDriverInfo(); // Выводим информацию о водителе.
}
