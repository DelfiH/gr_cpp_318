#include <iostream>
#include <limits>
#include <string>
#include <vector>
#include <algorithm>
#include <cctype>

using namespace std;

//-----------------------------------------------------------------------------
// Структура для представления информации о городе
//-----------------------------------------------------------------------------
struct City {
  string name;      // Название города
  string region;    // Область/Регион
  string capital;   // Столица
  string country;   // Государство/Страна
  string continent; // Материк
};

//-----------------------------------------------------------------------------
// Функция для преобразования строки в нижний регистр
//-----------------------------------------------------------------------------
static inline string toLower(const string& str) {
    string result = str;
    transform(result.begin(), result.end(), result.begin(), ::tolower);
    return result;
}

//-----------------------------------------------------------------------------
// Функция для поиска и вывода информации о городе
//-----------------------------------------------------------------------------
void findCityInfo(const vector<City>& cities, const string& cityName) {
  // Ищем город в векторе
  for (const auto& city : cities) {
    if (toLower(city.name) == toLower(cityName)) { // Сравниваем в нижнем регистре
      cout << "Область/Регион: " << city.region << endl;
      cout << "Столица: " << city.capital << endl;
      cout << "Государство/Страна: " << city.country << endl;
      cout << "Материк: " << city.continent << endl;
      return; // Выходим из функции, если город найден
    }
  }
  cout << "Данная информация отсутствует" << endl; // Если город не найден
}

//-----------------------------------------------------------------------------
// Функция для проверки корректности ввода (y/n)
//-----------------------------------------------------------------------------
bool isValidChoice(char choice) {
  return (choice == 'y' || choice == 'n');
}

//-----------------------------------------------------------------------------
// Функция task3
//-----------------------------------------------------------------------------
void task3() {
  // Создание объектов структуры в статической памяти
  City moscow = {"Москва", "Москва", "Москва", "Россия", "Евразия"};
  City london = {"Лондон", "Лондон", "Лондон", "Великобритания", "Евразия"};
  City paris = {"Париж", "Иль-де-Франс", "Париж", "Франция", "Евразия"};
  City tokyo = {"Токио", "Токио", "Токио", "Япония", "Евразия"};
  City newYork = {"Нью-Йорк", "Нью-Йорк", "Вашингтон", "США", "Северная Америка"};
  City sydney = {"Сидней", "Новый Южный Уэльс", "Канберра", "Австралия", "Австралия"};
  City rio = {"Рио-де-Жанейро", "Рио-де-Жанейро", "Бразилиа", "Бразилия", "Южная Америка"};
  City cairo = {"Каир", "Каир", "Каир", "Египет", "Африка"};
  City beijing = {"Пекин", "Пекин", "Пекин", "Китай", "Евразия"};
  City rome = {"Рим", "Лацио", "Рим", "Италия", "Евразия"};

  // Создание объектов структуры в динамической памяти
  City* berlin = new City{"Берлин", "Берлин", "Берлин", "Германия", "Евразия"};
  City* ottawa = new City{"Оттава", "Онтарио", "Оттава", "Канада", "Северная Америка"};

  // Создание вектора городов и добавление статических и динамических объектов
  vector<City> cities = {moscow,   london,  paris,   tokyo,   newYork, sydney, rio, cairo, beijing, rome, *berlin, *ottawa};

  // Освобождаем динамическую память после использования
  delete berlin;
  delete ottawa;
  berlin = nullptr;  // чтобы избежать висячих указателей
  ottawa = nullptr;

  string cityName; // Название города для поиска
  char choice;     // Выбор пользователя (y/n)

  do {
    cout << "\nВыберите город из списка:" << endl;
    // Выводим список городов
    for (const auto& city : cities) {
      cout << "- " << city.name << endl;
    }
    cout << "Введите название города (или 'q' для выхода): ";
    cin >> cityName;

    // Проверка ввода на "q" для выхода
    if (toLower(cityName) == "q") {
      break; // Выход из цикла, если введено 'q'
    }

    // Поиск информации о городе
    findCityInfo(cities, cityName);

    // Запрашиваем у пользователя, хочет ли он повторить поиск
    cout << "Хотите повторить поиск? (y/n): ";
    cin >> choice;

    // Защита от "дурака" при вводе ответа о повторе поиска
    while (cin.fail() || !isValidChoice(choice)) {
      cout << "Некорректный ввод. Пожалуйста, введите 'y' или 'n': ";
      cin.clear();
      cin.ignore(numeric_limits<streamsize>::max(), '\n');
      cin >> choice;
    }

  } while (choice == 'y'); // Повторяем цикл, если пользователь ввел 'y'

  cout << "До свидания!" << endl;
}
